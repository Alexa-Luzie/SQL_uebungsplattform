<div *ngIf="loading">Lade Aufgaben...</div>
<div *ngIf="error" class="error">{{ error }}</div>

<!-- Zeige "Keine Aufgaben vorhanden" und "Neue Aufgabe" nur bei der Route /tasks -->
<div *ngIf="!loading && tasks.length === 0 && !error && isTasksRoute()">Keine Aufgaben vorhanden.</div>
<button *ngIf="isLehrkraft() && isTasksRoute() && tasks.length === 0" (click)="showForm = true">Neue Aufgabe</button>

<!-- Dropdown-Menü für Studierende, Liste für Lehrkräfte -->
<ng-container *ngIf="!loading && tasks.length > 0">
  <ng-container *ngIf="!isLehrkraft(); else lehrkraftList">
    <label for="taskSelect">Aufgabe auswählen:</label>
    <select id="taskSelect" (change)="onDropdownChange($event)">
      <option value="">Bitte Aufgabe wählen</option>
      <option *ngFor="let task of tasks" [value]="task.id">{{ task.title }}</option>
    </select>
    <div *ngIf="selectedTask">
      <strong>Beschreibung:</strong>
      <div>{{ selectedTask.description }}</div>
    </div>
  </ng-container>
  <ng-template #lehrkraftList>
    <ul>
      <li *ngFor="let task of tasks" (click)="selectTask(task)">
        <strong>{{ task.title }}</strong> – {{ task.description }}
        <button *ngIf="isLehrkraft()" (click)="onEdit(task); $event.stopPropagation()">Bearbeiten</button>
        <button *ngIf="isLehrkraft()" (click)="onDelete(task.id); $event.stopPropagation()">Löschen</button>
      </li>
    </ul>
  </ng-template>
</ng-container>

<app-task-form
  *ngIf="showForm"
  [task]="editTask"
  (taskCreated)="onTaskCreated($event)"
  (taskUpdated)="onTaskUpdated($event)"
  (cancel)="onCancel()"
></app-task-form>